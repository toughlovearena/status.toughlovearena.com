(this["webpackJsonpstatus.toughlovearena.com"]=this["webpackJsonpstatus.toughlovearena.com"]||[]).push([[0],{31:function(e,t,n){"use strict";n.r(t);var r,c,a,s,i,o=n(1),l=n.n(o),u=n(19),d=n.n(u),h=n(4),j=n(8),b=n(9),f=b.a.div(r||(r=Object(j.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n\n  padding: 2rem 1rem;\n  box-sizing: border-box;\n  max-width: 800px;\n\n  @media (min-width: 800px) {\n    max-width: 1200px;\n  }\n"]))),v=b.a.div(c||(c=Object(j.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n\n  @media (min-width: 800px) {\n    flex-direction: row;\n    justify-content: center;\n    align-items: flex-start;\n    flex-wrap: wrap;\n  }\n"]))),O=b.a.div(a||(a=Object(j.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: center;\n  flex-wrap: nowrap;\n\n  @media (min-width: 800px) {\n    width: 500px;\n  }\n"]))),x=b.a.div(s||(s=Object(j.a)(["\n  font-size: 1.5em;\n  margin: 1em 0;\n  margin-bottom: 0.5em;\n"]))),p=b.a.table(i||(i=Object(j.a)(["\n  font-size: 1rem;\n  border-collapse: collapse;\n\n  th,\n  td {\n    text-align: center;\n    border: 1px solid grey;\n    padding: 0.5em 1em;\n    background-color: rgb(60, 60, 60);\n  }\n\n  th {\n    background-color: inherit;\n  }\n"]))),m=n(11),g=n(5),w=n.n(g),k=n(10),y=n(2),S=n(3);function E(){return!!new URLSearchParams(window.location.search).get("long")}function T(e){return fetch(e+"?cache="+(new Date).getTime())}var R=new(function(){function e(t){Object(y.a)(this,e),this.threads=void 0,this.count=0,this.queue=[],this.threads=Math.max(1,null!==t&&void 0!==t?t:3)}return Object(S.a)(e,[{key:"enqueue",value:function(e){var t,n=this,r=this.count++,c=function(){var e=function(){},t=function(){},n=!1,r=!1;return{promise:new Promise((function(c,a){e=function(e){n=!0,c(e)},t=function(e){r=!0,a(e)}})),resolve:e,reject:t,hasResolved:function(){return n},hasErrored:function(){return r}}}(),a=function(){var t=Object(k.a)(w.a.mark((function t(){return w.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e().then((function(e){return c.resolve(e)})).catch((function(e){return c.resolve(e)})).finally((function(){return n.dequeue(r)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),s=this.queue.length-this.threads,i=this.queue[s];return(null!==(t=null===i||void 0===i?void 0:i.resolvable.promise)&&void 0!==t?t:Promise.resolve()).catch(console.log).finally(a),this.queue.push({id:r,resolvable:c}),c}},{key:"dequeue",value:function(e){this.queue=this.queue.filter((function(t){return t.id!==e}))}}]),e}());function _(e){return R.enqueue((function(){return T(e)})).promise}function C(e,t){for(var n=[],r=0;r<e.length;)n.push(e.slice(r,r+t)),r+=t;return n}var q,P,A=new(function(){function e(){var t=this;Object(y.a)(this,e),this.PERIOD=1e3*(E()?300:30),this.callbacks={},setInterval((function(){return t.step()}),this.PERIOD)}return Object(S.a)(e,[{key:"step",value:function(){Object.values(this.callbacks).forEach((function(e){return e&&e()}))}},{key:"register",value:function(e,t){var n=this;return void 0!==this.callbacks[e]||t(),this.callbacks[e]=t,function(){return n.unregister(e)}}},{key:"unregister",value:function(e){this.callbacks[e]=function(){}}}]),e}()),M=n(0),L=b.a.a(q||(q=Object(j.a)(["\n  color: ",";\n  text-decoration: none;\n"])),(function(e){return e.isUp?"lightgreen":"salmon"}));function D(e){var t=e.label,n=e.url,r=e.report,c=Object(o.useState)(void 0),a=Object(h.a)(c,2),s=a[0],i=a[1],l=Object(o.useState)(void 0),u=Object(h.a)(l,2),d=u[0],j=u[1],b=Object(o.useCallback)((function(){R.enqueue(Object(k.a)(w.a.mark((function e(){var t,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=performance.now(),e.prev=1,e.next=4,T(n);case 4:if(e.sent.ok){e.next=7;break}throw new Error("fetch failed: "+n);case 7:i(!0),r(!0),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),i(!1),r(!1);case 15:c=performance.now(),j(Math.round(c-t));case 17:case"end":return e.stop()}}),e,null,[[1,11]])}))))}),[n,r,i,j]);return Object(o.useEffect)((function(){return A.register("poll-".concat(t),(function(){return b()}))}),[t,b]),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:t}),Object(M.jsx)("td",{children:void 0===s?"???":Object(M.jsx)(L,{href:n,isUp:s,children:s?"OK":"DOWN"})}),Object(M.jsx)("td",{children:null!==d&&void 0!==d?d:"???"})]})}var F=[{label:"toughlovearena.com",url:"https://toughlovearena.com/version.json"},{label:"cache.tla",url:"https://cache.toughlovearena.com/health"},{label:"handshake.tla",url:"https://handshake.toughlovearena.com/health"},{label:"leaderboard.tla",url:"https://leaderboard.toughlovearena.com/health"},{label:"matchmaker.tla",url:"https://matchmaker.toughlovearena.com"},{label:"presence.tla",url:"https://presence.toughlovearena.com/health"},{label:"lobbya.tla",url:"https://lobbya.toughlovearena.com/health"},{label:"lobbyb.tla",url:"https://lobbyb.toughlovearena.com/health"},{label:"ice.tla",url:"https://ice.toughlovearena.com/health"},{label:"serverless accounts API\t",url:"https://us-central1-fighter-api.cloudfunctions.net/webApi/api/v1/"}],I=b.a.a(P||(P=Object(j.a)(["\n  color: ",";\n"])),(function(e){return e.isUp?"lightgreen":"salmon"})),U={};function B(){var e=Object(o.useState)(void 0),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(o.useCallback)((function(e,t){U[e]=t,r(Object.values(U).every((function(e){return e})))}),[r]);return Object(M.jsxs)(O,{children:[Object(M.jsxs)(x,{children:["Status: ",void 0===n?"???":Object(M.jsx)(I,{isUp:n,children:n?"OK":"DOWN"})]}),Object(M.jsxs)(p,{children:[Object(M.jsx)("thead",{children:Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{children:"Service"}),Object(M.jsx)("th",{children:"Status"}),Object(M.jsx)("th",{children:"ms"})]})}),Object(M.jsx)("tbody",{children:F.map((function(e,t){return Object(M.jsx)(D,Object(m.a)({report:function(t){return c(e.url,t)}},e),t)}))})]})]})}function Q(){var e=Object(o.useState)(void 0),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(o.useCallback)(Object(k.a)(w.a.mark((function e(){var t,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("https://toughlovearena.com/version.json");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r(n.v);case 7:case"end":return e.stop()}}),e)}))),[r]);return Object(o.useEffect)((function(){return A.register("version",(function(){return c()}))}),[c]),Object(M.jsx)("div",{children:Object(M.jsxs)("a",{href:"https://toughlovearena.com?changelog",children:["v",null!==n&&void 0!==n?n:"???"]})})}function G(){var e=Object(o.useState)(void 0),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(o.useCallback)(Object(k.a)(w.a.mark((function e(){var t,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("https://us-central1-fighter-api.cloudfunctions.net/webApi/api/v1/news");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r(n.message);case 7:case"end":return e.stop()}}),e)}))),[r]);Object(o.useEffect)((function(){return A.register("news",(function(){return c()}))}),[c]);var a=(void 0===n?"???":n)||"<i>no news</i>";return Object(M.jsxs)("div",{children:["News: ",Object(M.jsx)("span",{dangerouslySetInnerHTML:{__html:a}})]})}function W(){var e=Object(o.useState)(void 0),t=Object(h.a)(e,2),n=t[0],r=t[1],c=Object(o.useCallback)(Object(k.a)(w.a.mark((function e(){var t,n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_("https://presence.toughlovearena.com");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,r(n);case 7:case"end":return e.stop()}}),e)}))),[r]);Object(o.useEffect)((function(){return A.register("activePlayers",(function(){return c()}))}),[c]);var a=n?Object.values(n).reduce((function(e,t){return t+e}),0):"???",s=function(e){var t;return null!==(t=n&&n[e])&&void 0!==t?t:"?"};return Object(M.jsxs)(O,{children:[Object(M.jsxs)(x,{children:["Active Players: ",a]}),Object(M.jsxs)(p,{children:[Object(M.jsx)("thead",{children:Object(M.jsxs)("tr",{children:[Object(M.jsx)("th",{children:"Game Mode"}),Object(M.jsx)("th",{children:"#"}),Object(M.jsx)("th",{children:"Game Mode"}),Object(M.jsx)("th",{children:"#"})]})}),Object(M.jsxs)("tbody",{children:[Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Welcome"}),Object(M.jsx)("td",{children:s("welcome")}),Object(M.jsx)("td",{children:"Menu"}),Object(M.jsx)("td",{children:s("menu")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"How to Play"}),Object(M.jsx)("td",{children:s("how_to_play")}),Object(M.jsx)("td",{children:"Ranked Match"}),Object(M.jsx)("td",{children:s("online_ranked")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Local Versus"}),Object(M.jsx)("td",{children:s("vs_local")}),Object(M.jsx)("td",{children:"Casual Match"}),Object(M.jsx)("td",{children:s("online_casual")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Versus CPU"}),Object(M.jsx)("td",{children:s("vs_cpu")}),Object(M.jsx)("td",{children:"Private Match"}),Object(M.jsx)("td",{children:s("online_private")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Boss Fight"}),Object(M.jsx)("td",{children:s("vs_boss")}),Object(M.jsx)("td",{children:"Private Lobby"}),Object(M.jsx)("td",{children:s("online_lobby")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Training"}),Object(M.jsx)("td",{children:s("training")}),Object(M.jsx)("td",{children:"Account Login"}),Object(M.jsx)("td",{children:s("online_account")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Frame Data"}),Object(M.jsx)("td",{children:s("frame_data")}),Object(M.jsx)("td",{children:"Account Stats"}),Object(M.jsx)("td",{children:s("online_stats")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Debug Ref"}),Object(M.jsx)("td",{children:s("debug_ref")}),Object(M.jsx)("td",{children:"Leaderboard"}),Object(M.jsx)("td",{children:s("online_leaderboard")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"About"}),Object(M.jsx)("td",{children:s("about")}),Object(M.jsx)("td",{children:"Hall of Fame"}),Object(M.jsx)("td",{children:s("hall_of_fame")})]}),Object(M.jsxs)("tr",{children:[Object(M.jsx)("td",{children:"Modding"}),Object(M.jsx)("td",{children:s("modding")}),Object(M.jsx)("td",{children:"Replay"}),Object(M.jsx)("td",{children:s("replay")})]})]})]})]})}var z,H,N,J=n(12),K=function e(t){Object(y.a)(this,e),this.chart=void 0;var n=t.canvasElm,r=t.label,c=t.colorRGB,a=n.getContext("2d");J.d.register(J.a,J.b,J.c,J.e);var s=new J.d(a,{type:"bar",data:{labels:[],datasets:[{label:r,data:[],backgroundColor:"rgba(".concat(c.r,", ").concat(c.g,", ").concat(c.b,", 0.2)"),borderColor:"rgba(".concat(c.r,", ").concat(c.g,", ").concat(c.b,", 1)"),borderWidth:1}]},options:{plugins:{legend:{display:!1}},responsive:!0,maintainAspectRatio:!0,scales:{x:{title:{display:!0,text:"seconds waiting for match",color:"white"},ticks:{color:"white"}},y:{beginAtZero:!0,title:{display:!0,text:"matches",color:"white"},ticks:{color:"white"}}}}});this.chart=s},V=n(6),Z=new(function(){function e(){var t=this;Object(y.a)(this,e),this.casual=void 0,this.ranked=void 0,A.register("chart",(function(){return t.step()}))}return Object(S.a)(e,[{key:"registerCasual",value:function(e){this.casual=e,this.step()}},{key:"registerRanked",value:function(e){this.ranked=e,this.step()}},{key:"convertQueueTimesToData",value:function(e){console.log(e);var t={},n=Object.keys(e).sort().pop();if(n){var r=e[n];for(var c in r){var a=parseFloat(c.split("s")[0]),s=r[c];t[a.toString()]=(t[a.toString()]||0)+s}var i=[],o=0,l=0;for(var u in t){var d=parseFloat(u),h=t[u];i.push({seconds:d,count:h}),o+=d*h,l+=h}var j=o/l,b=function(e){for(var t=[],n=0;n<e;n++)t.push(n);return t}(Math.max.apply(Math,Object(V.a)(i.map((function(e){return e.seconds}))))+1),f=b.map((function(e){return t[e.toString()]||0}));return{labels:C(b,5).map((function(e){return"".concat(e[0]," - ").concat(e.concat().pop())})),values:C(f,5).map((function(e){return e.reduce((function(e,t){return e+t}),0)})),average:j}}}},{key:"step",value:function(){var e=Object(k.a)(w.a.mark((function e(){var t,n,r,c,a=this;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.prev=1,e.next=4,_("https://matchmaker.toughlovearena.com/details");case 4:return n=e.sent,e.next=7,n.json();case 7:r=e.sent,c=r.filter((function(e){return"prod"===e.label}))[0],this.casual&&t.push({queueTimes:c.casual.queueTimes,ref:this.casual}),this.ranked&&t.push({queueTimes:c.ranked.queueTimes,ref:this.ranked}),t.forEach((function(e){var t=a.convertQueueTimesToData(e.queueTimes);if(t){for(;null===(n=e.ref.chart.chart.data.labels)||void 0===n?void 0:n.length;){var n;e.ref.chart.chart.data.labels.pop()}e.ref.chart.chart.data.datasets.forEach((function(e){for(;e.data.length;)e.data.pop()})),t.labels.forEach((function(t){return e.ref.chart.chart.data.labels.push(t)})),t.values.forEach((function(t){return e.ref.chart.chart.data.datasets.forEach((function(e){return e.data.push(t)}))})),e.ref.chart.chart.update(),e.ref.setAverage(Math.round(t.average))}})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(1),console.log(e.t0),t.forEach((function(e){e.ref.setAverage(void 0)}));case 18:case"end":return e.stop()}}),e,this,[[1,14]])})));return function(){return e.apply(this,arguments)}}()}]),e}());function X(){var e=Object(o.useRef)(null),t=Object(o.useState)(void 0),n=Object(h.a)(t,2),r=n[0],c=n[1];return Object(o.useEffect)((function(){if(e.current){var t=new K({canvasElm:e.current,label:"Ranked Queue Time",colorRGB:{r:162,g:100,b:235}});Z.registerRanked({chart:t,setAverage:c})}}),[e,c]),Object(M.jsxs)(O,{children:[Object(M.jsxs)(x,{children:["Ranked Queue Time: ",null!==r&&void 0!==r?r:"???"," seconds"]}),Object(M.jsx)("canvas",{ref:e})]})}function Y(){var e=Object(o.useRef)(null),t=Object(o.useState)(void 0),n=Object(h.a)(t,2),r=n[0],c=n[1];return Object(o.useEffect)((function(){if(e.current){var t=new K({canvasElm:e.current,label:"Casual Queue Time",colorRGB:{r:54,g:162,b:235}});Z.registerCasual({chart:t,setAverage:c})}}),[e,c]),Object(M.jsxs)(O,{children:[Object(M.jsxs)(x,{children:["Casual Queue Time: ",null!==r&&void 0!==r?r:"???"," seconds"]}),Object(M.jsx)("canvas",{ref:e})]})}var $=b.a.div(z||(z=Object(j.a)(["\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid white;\n"]))),ee=b.a.img(H||(H=Object(j.a)(["\n  display: block;\n  width: 100%;\n  max-width: 600px;\n  height: auto;\n  margin: auto;\n"]))),te=b.a.div(N||(N=Object(j.a)(["\n  margin-top: 1rem;\n  padding-top: 0.5rem;\n  border-top: 1px solid white;\n"])));function ne(){var e,t=Object(o.useState)(void 0),n=Object(h.a)(t,2),r=n[0],c=n[1];Object(o.useEffect)((function(){return A.register("updated",(function(){return c(new Date)}))}),[c]);var a=!!new URLSearchParams(window.location.search).get("simple");return Object(M.jsxs)(f,{children:[Object(M.jsxs)($,{children:[Object(M.jsx)(ee,{src:"logo.png",alt:"logo"}),Object(M.jsx)("div",{children:"Tough Love Arena Status Page"}),Object(M.jsx)(Q,{}),Object(M.jsx)(G,{})]}),Object(M.jsxs)(v,{children:[Object(M.jsx)(B,{}),Object(M.jsx)(W,{}),!a&&Object(M.jsx)(X,{}),!a&&Object(M.jsx)(Y,{})]}),Object(M.jsxs)(te,{children:["Updates every 30 seconds",Object(M.jsx)("br",{}),"Last updated @ ",null!==(e=null===r||void 0===r?void 0:r.toLocaleTimeString())&&void 0!==e?e:"???",Object(M.jsx)("br",{}),"If anything is down, please email ",Object(M.jsx)("a",{href:"mailto:toughlovearena@gmail.com",children:"toughlovearena@gmail.com"})]})]})}var re=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};d.a.render(Object(M.jsx)(l.a.StrictMode,{children:Object(M.jsx)(ne,{})}),document.getElementById("root"));var ce=60*(E()?60:5)*1e3;setInterval((function(){return window.location.reload(!1)}),ce),re()}},[[31,1,2]]]);
//# sourceMappingURL=main.3905e68b.chunk.js.map